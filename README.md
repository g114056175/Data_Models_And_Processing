# æ™‚ç©ºäººæµé æ¸¬ - ResNetæ·±åº¦å­¸ç¿’æ¨¡å‹

![Python](https://img.shields.io/badge/python-3.8+-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Status](https://img.shields.io/badge/status-complete-success.svg)

åŸºæ–¼ResNetæ¶æ§‹çš„æ™‚ç©ºäººæµé æ¸¬ç³»çµ±ï¼Œä½¿ç”¨å°åŒ—å¸‚75å¤©ï¼ˆ3,600æ™‚æ®µï¼‰çš„ç¶²æ ¼äººæµæ•¸æ“šã€‚

## ğŸ¯ å°ˆæ¡ˆç›®æ¨™

é æ¸¬æŒ‡å®šç¶²æ ¼çš„æœªä¾†äººæµé‡ï¼Œä¸¦æä¾›äººæµçˆ†é‡é è­¦ï¼Œè¼”åŠ©äº¤é€šç®¡æ§å’Œäººæµç–æ•£æ±ºç­–ã€‚

## ğŸ“Š æ•¸æ“šæ¦‚è¦½

- **æ™‚é–“ç¯„åœ**: 75å¤©ï¼ˆ3,600å€‹æ™‚æ®µï¼Œæ¯æ™‚æ®µ30åˆ†é˜ï¼‰
- **ç©ºé–“ç¯„åœ**: 200Ã—200ç¶²æ ¼ï¼ˆ40,000å€‹ç¶²æ ¼ï¼‰
- **è¨˜éŒ„ç¸½æ•¸**: 9,614,255ç­†
- **é¸å®šç¶²æ ¼**: 3å€‹ï¼ˆæœ€é«˜äººæµã€ç¬¬äºŒé«˜äººæµã€æœ€å¤§ç¬é–“æ¹§å…¥ï¼‰

## ğŸ“¥ æ•¸æ“šä¸‹è¼‰

ç”±æ–¼åŸå§‹æ•¸æ“šæ–‡ä»¶ `data1.csv` (142.5MB) è¶…éGitHubæª”æ¡ˆå¤§å°é™åˆ¶ï¼Œè«‹å¾ä»¥ä¸‹é€£çµä¸‹è¼‰ï¼š

**ğŸ”— [ä¸‹è¼‰ data1.csv from Google Drive](https://drive.google.com/file/d/1vRWOoXnDL0aL0I9UQzt0XVc78vWOiySe/view?usp=drive_link)**

ä¸‹è¼‰å¾Œè«‹å°‡æ–‡ä»¶æ”¾ç½®æ–¼å°ˆæ¡ˆæ ¹ç›®éŒ„ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¨­ç½®

```bash
# å…‹éš†å°ˆæ¡ˆ
git clone <your-repo-url>
cd data_mah_hw

# å®‰è£ä¾è³´
pip install -r requirements.txt

# ä¸‹è¼‰æ•¸æ“šæ–‡ä»¶ï¼ˆè¦‹ä¸Šæ–¹é€£çµï¼‰
# å°‡ data1.csv æ”¾ç½®æ–¼æ ¹ç›®éŒ„
```

### å®Œæ•´åŸ·è¡Œæµç¨‹

```bash
# 1. ç©ºé–“åˆ†æï¼ˆè­˜åˆ¥é«˜äººæµç¶²æ ¼ï¼‰
python 22_spatial_analysis.py

# 2. Baselineè©•ä¼°
python 27_persistence_baseline_analysis.py

# 3. ç‰¹å¾µå·¥ç¨‹ï¼ˆæå–69ç¶­ç‰¹å¾µï¼‰
python 28_resnet_feature_engineering.py

# 4. è¨“ç·´ResNetæ¨¡å‹ï¼ˆç´„10-15åˆ†é˜ï¼‰
python 30_train_resnet.py

# 5. è©•ä¼°èˆ‡è¦–è¦ºåŒ–
python 34_regenerate_all_with_1sigma.py
```

## ğŸ“ é‡è¦è³‡æ–™å¤¾

| è³‡æ–™å¤¾ | èªªæ˜ |
|--------|------|
| `grid_selection/` | ç¶²æ ¼é¸æ“‡ç›¸é—œåœ–è¡¨ï¼ˆ11å¼µï¼‰ |
| `temp/` | æ¨¡å‹è©•ä¼°çµæœï¼ˆ18å¼µåœ–è¡¨ï¼‰ |
| `resnet_models/` | è¨“ç·´å¥½çš„æ¨¡å‹ï¼ˆ15å€‹.pthæª”ï¼‰ |
| `resnet_features/` | ç‰¹å¾µæ•¸æ“šï¼ˆ3å€‹ç¶²æ ¼ï¼‰ |
| `archived_scripts/` | æ­¸æª”çš„æ¸¬è©¦è…³æœ¬ |

## ğŸ¯ é¸å®šç¶²æ ¼

| # | åº§æ¨™ | ç‰¹å¾µ | ç´¯ç©äººæµ | MAE (æœ€ä½³) |
|---|------|------|----------|-----------|
| 1 | (80, 95) | æœ€é«˜äººæµ | 122,068 | 3.84 (Deep) |
| 2 | (80, 93) | ç¬¬äºŒé«˜äººæµ | 113,517 | 3.25 (Wide) |
| 3 | (79, 97) | æœ€å¤§ç¬é–“æ¹§å…¥ | 24,308 | 1.75 (GELU) |

## ğŸ¤– æ¨¡å‹è®Šé«”

è¨“ç·´äº†5å€‹ResNetè®Šé«”ï¼š

1. **Baseline ResNet**: 3å±¤, 128éš±è—å–®å…ƒ, ReLU
2. **Deep ResNet**: 6å±¤, 128éš±è—å–®å…ƒ, ReLUï¼ˆæ›´æ·±ï¼‰
3. **Wide ResNet**: 3å±¤, 256éš±è—å–®å…ƒ, ReLUï¼ˆæ›´å¯¬ï¼‰
4. **LeakyReLU ResNet**: 3å±¤, 128éš±è—å–®å…ƒ, LeakyReLU
5. **GELU ResNet**: 3å±¤, 128éš±è—å–®å…ƒ, GELUï¼ˆç¾ä»£æ¿€æ´»ï¼‰

## ğŸ“ˆ æ ¸å¿ƒæˆæœ

### vs Persistence Baseline

- **MAE é™ä½**: 40-48%
- **çˆ†é‡å¬å›ç‡æå‡**: å¾66%åˆ°84-88%
- **è¨“ç·´é€Ÿåº¦**: æ¯”LSTMå¿«3-5å€

### æœ€ä½³æ¨¡å‹

- **ç¶²æ ¼1**: Deep ResNet (MAE=3.84)
- **ç¶²æ ¼2**: Wide ResNet (MAE=3.25)
- **ç¶²æ ¼3**: GELU ResNet (MAE=1.75)

## ğŸ”¬ æŠ€è¡“ç‰¹é»

### ç‰¹å¾µå·¥ç¨‹ï¼ˆ69ç¶­ï¼‰

- **Lagç‰¹å¾µ**: t-1, t-2, ..., t-6, t-48, t-96, t-336
- **çµ±è¨ˆç‰¹å¾µ**: Rolling mean/std/min/max (12æ™‚æ®µçª—å£)
- **æ™‚é–“ç·¨ç¢¼**: 48å°æ™‚ + 7å¤© + é€±æœ«æ¨™è¨˜

### è¨“ç·´ç­–ç•¥

- **æå¤±å‡½æ•¸**: Weighted MSEï¼ˆçˆ†é‡äº‹ä»¶5xæ¬Šé‡ï¼‰
- **å„ªåŒ–å™¨**: Adam (lr=1e-3)
- **æ­£å‰‡åŒ–**: Dropout(0.2) + Weight Decay(1e-5)
- **æ—©åœ**: Patience=25 epochs
- **æ•¸æ“šåˆ†å‰²**: 60å¤©è¨“ç·´ / 15å¤©æ¸¬è©¦

## ğŸ“š æ–‡æª”

- **PROJECT_STRUCTURE.md** - å®Œæ•´å°ˆæ¡ˆçµæ§‹èªªæ˜
- **grid_selection/README.md** - ç¶²æ ¼é¸æ“‡è©³ç´°åˆ†æ
- **Brain artifacts** - æŠ€è¡“è¨­è¨ˆæ–‡æª”
  - `resnet_model_design.md`
  - `model_comparison_resnet_vs_rnn.md`
  - `report_writing_guide.md`

## ğŸ› ï¸ æ ¸å¿ƒè…³æœ¬èªªæ˜

| è…³æœ¬ | åŠŸèƒ½ |
|------|------|
| `22_spatial_analysis.py` | ç©ºé–“åˆ†æèˆ‡Top5è­˜åˆ¥ |
| `27_persistence_baseline_analysis.py` | Persistence baselineè©•ä¼° |
| `28_resnet_feature_engineering.py` | ResNetç‰¹å¾µå·¥ç¨‹ |
| `29_resnet_models.py` | ResNetæ¨¡å‹å®šç¾© |
| `30_train_resnet.py` | æ¨¡å‹è¨“ç·´ |
| `34_regenerate_all_with_1sigma.py` | å®Œæ•´è©•ä¼°èˆ‡è¦–è¦ºåŒ– |

## ğŸ“Š è¼¸å‡ºåœ–è¡¨

### grid_selection/ (11å¼µ)
- 3å¼µæ™‚åºåœ–
- 3å¼µé¸æ“‡ç†ç”±ç†±åœ–
- 1å¼µç©ºé–“ç†±åœ–
- 2å¼µbaselineåˆ†æåœ–
- 1å¼µå°æ¯”åœ–

### temp/ (18å¼µ)
- 15å¼µé æ¸¬å°æ¯”åœ–ï¼ˆ3ç¶²æ ¼ Ã— 5æ¨¡å‹ï¼‰
- 3å¼µæ··æ·†çŸ©é™£

## ğŸ“ ç‚ºä»€éº¼é¸æ“‡ResNetï¼Ÿ

1. **è¨“ç·´é€Ÿåº¦å¿«**: æ¯”LSTMå¿«3-5å€ï¼ˆä¸¦è¡Œè™•ç†ï¼‰
2. **æ¢¯åº¦ç©©å®š**: æ®˜å·®é€£æ¥å®Œå…¨è§£æ±ºæ¢¯åº¦æ¶ˆå¤±
3. **å¤šç¶­ç‰¹å¾µ**: æ“…é•·è™•ç†69ç¶­ç‰¹å¾µçµ„åˆ
4. **å¯è§£é‡‹æ€§**: æ˜ç¢ºçš„ç‰¹å¾µå·¥ç¨‹ï¼Œéé»‘ç›’æ¨¡å‹
5. **å¯¦é©—æ•ˆç‡**: å¿«é€Ÿè¿­ä»£ï¼Œæ˜“æ–¼èª¿åƒ

è©³è¦‹: `model_comparison_resnet_vs_rnn.md`

## ğŸ“ å ±å‘Šæ’°å¯«

åƒè€ƒ `report_writing_guide.md`ï¼ŒåŒ…å«ï¼š
- å…©éšæ®µå®Œæ•´æµç¨‹
- æ‰€éœ€åœ–è¡¨æ¸…å–®
- æ–‡å­—èªªæ˜ç¯„æœ¬
- æ ¸å¿ƒç™¼ç¾ç¸½çµ

## ğŸ”§ æ•…éšœæ’é™¤

### è¨˜æ†¶é«”ä¸è¶³
```bash
# æ¸›å°‘æ‰¹æ¬¡å¤§å°ï¼ˆåœ¨ 30_train_resnet.py ä¸­ï¼‰
batch_size = 32  # æ”¹ç‚º32æˆ–16
```

### è¨“ç·´å¤ªæ…¢
```bash
# ä½¿ç”¨GPUï¼ˆå¦‚æœæœ‰ï¼‰
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
```

## æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT License - è©³è¦‹ [LICENSE](LICENSE) æ–‡ä»¶

æœ¬å°ˆæ¡ˆä¾›å­¸è¡“ç ”ç©¶ä½¿ç”¨ï¼Œå¦‚ä½¿ç”¨è«‹å¼•ç”¨æœ¬å°ˆæ¡ˆã€‚

---

**æœ€å¾Œæ›´æ–°**: 2025-12-26  
**ç‰ˆæœ¬**: 2.0  
**ç‹€æ…‹**: âœ… å·²æ¸…ç†ä¸¦æº–å‚™æ¨é€GitHub

